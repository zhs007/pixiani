# 项目概要: PixiJS 动画库

这是一个使用 Pixi.js 和 TypeScript 开发的、面向移动端竖屏的 Web 游戏动画库。

## 重要信息与规则

### 技术栈
- **渲染引擎:** Pixi.js (最新版)
- **渲染模式:** WebGL
- **开发语言:** TypeScript
- **构建工具:** Vite
- **测试框架:** Vitest

### 核心设计原则
1.  **模块化:** 功能被划分到不同的 "package" (目录) 中。`core` 包含核心逻辑, `animations` 包含具体的动画实现。
2.  **类型安全:** 所有模块都必须有完整的 TypeScript 类型定义。核心类型定义在 `src/core/types.ts`。
3.  **高可测试性:** 核心逻辑模块必须有单元测试，目标覆盖率 > 90%。
4.  **详细注释:** 所有公开的类、方法和复杂逻辑都需要有 JSDoc 注释。
5.  **关注相对变换:** 动画应该只修改 Sprite 的相对属性（如相对于其初始状态的缩放、位置偏移），而不是其在世界坐标系中的绝对位置。

### 核心模块
-   **`AnimationManager`**: 全局单例，用于注册、创建和管理所有动画实例的生命周期，包括全局暂停、恢复和变速。
-   **`BaseObject`**: 一个可以附加动画组件的容器。游戏中的对象可以通过组合 `BaseObject` 来获得动画能力。
-   **`BaseAnimate`**: 所有具体动画的基类，定义了动画的基本接口 (`play`, `pause`, `update` 等)。

### Sprite 插槽机制
-   动画不直接创建 `Sprite`，而是通过外部传入一组 `Sprite`（即插槽）来工作。
-   每个动画类必须实现一个方法，用于声明它需要多少个 `Sprite` 插槽。
-   动画逻辑负责决定如何使用这些传入的 `Sprite`。

### 渲染顺序
-   动画库本身不直接修改 `PIXI.Sprite` 的 `zIndex` 或渲染顺序。
-   如果动画需要改变渲染顺序（例如，一个角色转身，需要将后发切换为前发），它会通过一个回调函数通知外部使用者，由外部逻辑来调整 `Sprite` 在 Pixi 容器中的层级。

### 开发流程
1.  **定义类型:** 在 `src/core/types.ts` 中添加新的接口或类型。
2.  **实现核心逻辑:** 在 `src/core` 中实现或修改核心类。
3.  **编写动画:** 在 `src/animations` 目录下创建新的动画文件，继承 `BaseAnimate`。
4.  **编写测试:** 在 `tests` 目录下为新功能编写单元测试。
5.  **演示验证:** 在 `demo` 页面中添加新的测试用例，直观地验证动画效果。
6.  **构建与提交:** 运行 `npm run build` 和 `npm run test`，确保一切正常后提交。

### 命令
-   `npm run dev`: 启动开发服务器，访问 `demo/index.html`。
-   `npm run build`: 构建生产版本的库。
-   `npm run test`: 运行单元测试。
